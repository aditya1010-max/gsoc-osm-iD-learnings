First of all Kbar is a "Overlay UI tool"

- iD is build in horizontal layers not a single stack 

- layers are -
data/graph , Modes , Actions , UI Components , Overlays

-In short,
Map and rendering layer is the bottommost layer,
- it map tiles, vector rendering , enteties, graph , history, D3 rendering of map

Modes layer
-These are things like Browse, Add Point, Add Line, Select 
- It control how click behaves or how mouse/keyboard interacts with the map
(kbar activates these modes, it is not one by itself)

Action layer
- There are things like Undo, redo, save , operation on state 
- kbar references actions but dosent own them.(like another doorway to actions and modes)

UI layer 
- Ih has side panels , inspectors, dialogs , toolbars and popovers 
- Kbar lives here.

Overlay Layer 
- Its basically UI layer but these are temporarily visible, float abive the map , steal focus and disappear
- some exaples could be search dialogs, confirmation modals or help popups.

-kbar is exactly this 
. its shown/hidden
. not mounted/unmounted 
. foucus is managed carefully
. it does not affect the layout


Kbar build ?

- it is initialized once 
- DOM created once 
- it is hidden by default 
- showm when needed 


- it is build during UI setup
- lives quietly in DOM
- activated on demand


Kbar Interaction With Layers (Important Mental Model)

User presses shortcut
   ↓
kbar overlay becomes visible
   ↓
kbar queries registry (UI → modes/actions)
   ↓
kbar filters results (pure UI logic)
   ↓
User selects command
   ↓
kbar triggers action / enters mode
   ↓
kbar closes and hands control back

