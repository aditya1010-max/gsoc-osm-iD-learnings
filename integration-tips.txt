main things to keep in mind for applying kbar functionality in osm-iD

1. Respect iD‚Äôs mode-driven architecture

iD lives and breathes modes (browse, add-point, draw-line, etc.).

Keep in mind:

kbar actions should almost always enter a mode, not do heavy logic themselves.

Your onSelect should usually look like:

context.enter(modeAddPoint(context))


Never bypass mode logic just to ‚Äúdo the thing faster‚Äù.

üëâ If it doesn‚Äôt map cleanly to a mode, it probably doesn‚Äôt belong in kbar.




2. Actions must be context-aware

iD is stateful: selection, geometry, zoom, permissions, etc.

Before registering an action, think:

Does this action require a selection?

Does it only make sense for nodes / ways / areas?

Should it be disabled in read-only mode?

Rule of thumb:
If a button would be disabled in the UI, the kbar action should be hidden or disabled too.




3. Don‚Äôt duplicate existing shortcuts or UI

iD already has:

Keyboard shortcuts

Menus

Toolbars

kbar is for:

Discoverability

Speed for advanced users

Commands that are annoying to dig for

If something already has a perfect shortcut, adding it to kbar is optional‚Äînot mandatory.




4. Follow iD naming + UX conventions

kbar actions should sound like iD actions.

Good:

‚ÄúAdd Point‚Äù

‚ÄúDraw Line‚Äù

‚ÄúSplit Way‚Äù

Bad:

‚ÄúCreate a node here‚Äù

‚ÄúInitiate polyline creation‚Äù

Consistency matters because iD is used by thousands of contributors under the OpenStreetMap umbrella.





5. Think about availability tiers

A good mental model:

Always available

Enter browse mode

Add point / line / area

Search, help, preferences

Selection-dependent

Delete

Split

Reverse

Merge

Advanced / power-user

QA tools

Debug toggles

Experimental features

Structure your kbar registry accordingly‚Äîdon‚Äôt dump everything flat.




6. Lazy registration > eager logic

kbar should:

Register lightweight metadata

Defer heavy work until onSelect

Avoid:

Graph mutations during registration

Expensive checks every render

This keeps iD snappy.



7. Accessibility & keyboard flow matter

Remember:

kbar is keyboard-first

Titles should be searchable and obvious

Avoid cryptic abbreviations

If a mapper types ‚Äúadd‚Äù, they should immediately see the right actions.




8. Keep PRs small and scoped

For iD specifically:

One category of actions per PR

No unrelated refactors

Clear before/after behavior

Maintainers love incremental improvements.