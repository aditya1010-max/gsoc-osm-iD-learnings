kbar/
├─ index.js      → orchestrates everything
├─ registry.js   → defines WHAT actions exist
├─ palette.js    → builds DOM structure
├─ render.js     → renders action list
├─ filter.js     → search logic
├─ events.js     → keyboard + input handlers
├─ lifecycle.js  → open / close / cleanup



index.js is the entry point and orchestrator. It wires all the other modules together, initializes state, and exposes the public API used by the rest of the app (for example: open, close, toggle). If you want to understand how the whole kbar system boots up and flows end-to-end, this is the file to read first.


registry.js defines what actions exist. It’s purely declarative: commands, their ids, titles, shortcuts, icons, and what happens when you select them. This file does not care about UI or DOM — it’s the source of truth for “what can the command palette do?”


palette.js is responsible for building the DOM structure of the command palette. It creates the container, input field, list wrapper, and any structural elements needed. No logic, no filtering — just “what elements exist and how they’re nested.”


render.js handles how actions appear on screen. Given a list of actions (usually already filtered), it converts them into DOM nodes, updates the list, highlights selections, and keeps the UI in sync with state. This is where visual updates happen.


filter.js contains the search and matching logic. It takes user input and the full action list and returns the best-matching actions. This keeps fuzzy search, ranking, and performance concerns isolated from rendering and events.


events.js manages keyboard and input interactions. Arrow keys, Enter, Escape, typing in the input, focus changes — all of that lives here. It translates raw user events into high-level actions like “move selection” or “execute command.”


lifecycle.js controls open, close, and cleanup behavior. It handles mounting/unmounting the palette, attaching and removing listeners, resetting state, and ensuring nothing leaks when the palette is closed. Think of it as the hygiene and safety net of kbar.




// folder structure according to GEMINI (i actually prefer this one)

core/ (The Logic)
events.js: Manages global keyboard listeners and internal event dispatching for shortcuts and navigation.

filter.js: Contains the fuzzy search and ranking algorithms used to match user input against available actions.

lifecycle.js: Handles the initialization and cleanup logic, ensuring the palette is properly mounted and unmounted.

orchestrator.js: The central controller that coordinates state transitions, such as opening/closing and tracking the active selection.

registry.js: Acts as the data store for all registered actions, providing methods to add, remove, or fetch commands.

ui/ (The Visuals)
palette.js: The main container component for the modal, including the search input and high-level layout.

render.js: Handles the logic for drawing individual result items and managing the visual display of the results list.

Entry Point
index.js: The public-facing API that exports only the necessary functions and components for use in the rest of the application.